<div class="topMenuBar__buttonsWrapper">
  <div
    *ngFor="let button of buttons"
    class="topMenuBar__buttonWrapper">
    <button
      (click)="button.onClick()"
      [ngClass]="{
        'topMenuBar__button--enabled': button.enabled(),
        'topMenuBar__button--processing': getProcessingStatus(button.name) }"
      class="topMenuBar__button">
      <i
        [innerHTML]="button.icon"
        class="topMenuBar__button__icon icons">
      </i>
    </button>
    <div
      *ngIf="showLabels"
      class="topMenuBar__button__text">
      {{ button.name }}
    </div>
  </div>

  <div
    class="
      topMenuBar__buttonWrapper
      topMenuBar__moreButton">
    <button
      cdkOverlayOrigin
      #trigger="cdkOverlayOrigin"
      (click)="toggleSettingsOpen()"
      [ngClass]="{ 'topMenuBar__button--enabled': isSettingsOpen }"
      class="topMenuBar__button">
      <!-- TODO change to ellipsis icon -->
      <i
        [innerHTML]="'&#xe2a6;'"
        class="topMenuBar__button__icon icons">
      </i>
    </button>
    <div
      *ngIf="showLabels"
      class="topMenuBar__button__text">
      More
    </div>
    <ng-template
      cdkConnectedOverlay
      [cdkConnectedOverlayOrigin]="trigger"
      [cdkConnectedOverlayOpen]="isSettingsOpen"
      [cdkConnectedOverlayPositions]="getOverlayPositions()">
      <div class="topMenuBar__settingsOverlay">
        <ng-container *ngTemplateOutlet="topMenuBarSettings"></ng-container>
      </div>
    </ng-template>
  </div>
</div>

<div class="topMenuBar__deviceSelectorWrapper">
  <app-device-selector class="topMenuBar__deviceSelector"></app-device-selector>
</div>

<div class="topMenuBar__settingsWrapper">
  <ng-container *ngTemplateOutlet="topMenuBarSettings"></ng-container>
</div>

<div class="topMenuBar__liveViewWrapper">
  <app-live-view *ngIf="isLiveViewActive"></app-live-view>
</div>

<ng-template
  #topMenuBarSettings
  [formGroup]="topMenuBarForm">
  <app-color-slider
    [control]="topMenuBarForm.get('brightness')!"
    [min]="1"
    [max]="255"
    label="Brightness"
    labelClass="topMenuBar__slider__label"
    sliderClass="topMenuBar__slider__input"
    class="topMenuBar__slider">
    <!-- TODO should brightness slider icon toggle light/dark mode? -->
    <i
      class="icons slider-icon"
      (click)="toggleTheme()">
      &#xe2a6;
    </i>
  </app-color-slider>

  <div class="topMenuBar__transitionInputWrapper">
    <label
      for="topMenuBarTransitionInput"
      class="topMenuBar__settingLabel">
      Transition (s)
    </label>
    <input
      id="topMenuBarTransitionInput"
      type="number"
      formControlName="transitionTime"
      placeholder="0.7"
      min="0"
      max="65.5"
      step="0.1"
      class="topMenuBar__transitionInput">
  </div>
</ng-template>
